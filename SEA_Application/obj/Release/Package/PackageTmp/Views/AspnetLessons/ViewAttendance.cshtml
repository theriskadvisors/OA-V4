@{
    ViewBag.Title = "ViewAttendance";
    if (User.IsInRole("Teacher"))
    {
        Layout = "~/Views/Shared/_AdminDashboardLayout.cshtml";
    }
    else
    {
        Layout = "~/Views/Shared/_AdminDashboardLayout.cshtml";
    }
}
@{

    //Layout = "~/Views/Shared/_BranchAdminDashboardLayout.cshtml";

}

<style>
    /**/
    .announceSubjectList {
        overflow-y: auto;
        max-height: 310px;
        position: relative;
        overflow-x: hidden;
    }

    @@media print {
        #noprint {
            visibility: hidden;
        }
    }

        .announceSubjectList.ps-container > .ps-scrollbar-x-rail,
        .announceSubjectList.ps-container > .ps-scrollbar-y-rail {
            opacity: 0.6;
        }

            .announceSubjectList.ps-container > .ps-scrollbar-y-rail > .ps-scrollbar-y,
            .announceSubjectList.ps-container:hover > .ps-scrollbar-y-rail:hover > .ps-scrollbar-y,
            .announceSubjectList.ps-container:hover > .ps-scrollbar-y-rail > .ps-scrollbar-y {
                background-color: #009ecb;
            }

        .announceSubjectList .form-check-label {
            font-size: 16px;
            font-weight: normal;
            font-stretch: normal;
            font-style: normal;
            line-height: 1.63;
            letter-spacing: normal;
            text-align: left;
            color: #141437;
        }

    .lessonButton {
        font-size: 16px;
        font-weight: 600;
        font-stretch: normal;
        font-style: normal;
        /*! line-height: 1.61; */
        letter-spacing: normal;
        text-align: center;
        color: #ffffff;
        border-radius: 6px !important;
    }

    .text-muted.lessonButton {
        color: #afbccc !important;
        box-shadow: none;
        font-weight: 500;
    }

        .text-muted.lessonButton i {
            font-size: 25px;
        }
    /*subject list new*/
    .text-subjectList {
        font-size: 20px;
        font-weight: 600;
        font-stretch: normal;
        font-style: normal;
        letter-spacing: normal;
        text-align: left;
        color: #141437;
        display: inline;
        margin-right: 10px;
    }

    .topicsCount.subjectListCount span {
        box-shadow: 0 3px 6px 0 rgba(0, 0, 0, 0.16);
        border: solid 2px #ff8543;
        background-color: #ffffff;
        color: #ff8543;
        font-size: 14px;
        font-weight: 600;
    }

    .sub__box__text .time {
        font-size: 14px;
        font-weight: 500;
        font-stretch: normal;
        font-style: normal;
        letter-spacing: normal;
        text-align: left;
        color: #646480;
        display: inline-block;
        margin-bottom: 0;
    }

    .sub__box__text .form-check-sign {
        line-height: 32px;
    }

    .sub__box__text h3 {
        margin-top: 0;
        margin-bottom: 35px;
        font-size: 16px;
        font-weight: 500;
        font-stretch: normal;
        font-style: normal;
        letter-spacing: normal;
        text-align: left;
        color: #141437;
    }

    .progress__bar__bg {
        background-color: #e2e2ee;
        height: 5px;
    }

    .progress__bar {
        background-color: #ff8543;
        height: 5px;
        /*! display: inline-block; */
        width: 0;
    }

    .sub__box__text {
        position: relative;
        padding: 15px 12px;
        text-align: left;
        background-color: #f2f5fa;
    }

    .subject-list-box.subject-list-box-new {
        display: block;
        min-height: 0 !important;
        height: auto !important;
        border: none !important;
    }

        .subject-list-box.subject-list-box-new img {
            width: 100%;
        }

    .sub__box__text {
    }

    .progress__bar:after {
        /*   background-color: #e2e2ee;
    height: 5px; */
    }

    .subject-list-box.subject-list-box-new:hover {
        background-color: transparent;
        scale: 1.01;
    }

    .subject-list-box.subject-list-box-new *,
    .subject-list-box.subject-list-box-new {
        transition: width 0.4s cubic-bezier(0.4, 0, 1, 1), scale 0.1s cubic-bezier(0.4, 0, 1, 1), box-shadow 0.2s cubic-bezier(0.4, 0, 1, 1), background-color 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    }

        .subject-list-box.subject-list-box-new .form-check .form-check-input:checked ~ .form-check-sign .check::before {
            color: #ff8543;
        }
    /*attendance*/
    .student-attendance-headding h2 {
        font-size: 24px;
        font-weight: 500;
        font-stretch: normal;
        font-style: normal;
        letter-spacing: normal;
        text-align: left;
        color: #141437;
    }

    .attendance-btn button.fc-button.fc-state-default {
        font-size: 14px;
        font-weight: normal;
        border: solid 1px #e2e2ee !important;
        border-radius: 0 !important;
        height: 34px;
        width: 97px;
    }

        .attendance-btn button.fc-button.fc-state-default.att-present-btn.selected,
        .attendance-btn button.fc-button.fc-state-default.att-present-btn:hover {
            background-color: #45b84b !important;
            border-color: #45b84b !important;
        }

    .attendance-btn button i {
        margin-right: 5px;
    }

    .fc-button-group.attendance-btn .fc-agendaWeek-button.fc-button.fc-state-default.att-absent-btn.selected,
    .fc-button-group.attendance-btn .fc-agendaWeek-button.fc-button.fc-state-default.att-absent-btn:hover {
        background-color: #d92a2a;
    }

    .fc-button-group.attendance-btn {
    }

        .fc-button-group.attendance-btn .fc-listWeek-button.fc-button.fc-state-default.fc-corner-right.att-late-btn:hover,
        .fc-button-group.attendance-btn .fc-listWeek-button.fc-button.fc-state-default.fc-corner-right.att-late-btn.selected {
            background-color: #f6d132;
        }

    .att-present-btn.selected i, .att-present-btn.selected,
    .att-absent-btn.selected i, .att-absent-btn.selected,
    .att-late-btn.selected i, .att-late-btn.selected,
    .att-present-btn:hover i, .att-present-btn:hover,
    .att-absent-btn:hover i, .att-absent-btn:hover,
    .att-late-btn:hover i, .att-late-btn:hover {
        color: #fff !important;
    }

    .att-present-btn i {
        color: #45b84b !important;
    }

    .att-absent-btn i {
        color: #d92a2a !important;
    }

    .att-late-btn i {
        color: #f6d132 !important;
    }

    .datatablesData .dataTable > tbody > tr.rowHere > td {
        height: 80px !important;
    }

    .datatablesData.AttendanceTableCon .table > thead > tr > th {
        height: 40px;
        color: #646480 !important;
        font-weight: 500 !important;
        font-size: 14px !important;
    }

    .greenTick {
        color: #45b84b !important;
    }

    .redTimes {
        color: #d92a2a !important;
    }

    .yellowMinus {
        color: #f6d132 !important;
    }

    .lastSeven > div + div {
        margin-left: 5px;
    }

    .lastSeven > div {
        flex: 1;
    }

        .lastSeven > div p {
            margin-bottom: 3px;
        }

    .datatablesData.AttendanceTableCon tbody :not(button):not(.reasonText) {
        font-size: 16px !important;
        font-weight: 500 !important;
        line-height: 18px !important;
    }

    .datatablesData.AttendanceTableCon .table > thead > tr > th.attNumber,
    .attNumber {
        color: #c0c0d1 !important;
    }

    .attendance-btn input[type="radio"] {
        display: none;
    }

    span#heading {
        font-size: 24px !important;
        color: #000 !important;
        font-weight: bold !important;
    }
</style>


<div class="content">
    <div class="container-fluid" id="noprint">
        <div class="row">
            <div class="col-md-12">
                <div class="pageHeading">
                    <div class="row">
                        <div class="col-sm-12 col-md-6 col-lg-7">


                            <h1 class="">Lesson Attendance</h1>


                        </div>
                        <div class="col-sm-12 col-md-6 col-lg-5 align-items-center d-flex justify-content-end">
                            &nbsp;
                            <div class="student-attendance-headding align-items-center fc-left d-flex justify-content-between"><h2 class="m-0 mr-3"></h2><div class="fc-button-group"><button type="button" class="fc-prev-button fc-button fc-state-default fc-corner-left hidden" aria-label="prev"><span class="fc-icon fc-icon-left-single-arrow"></span></button><button type="button" class="fc-next-button fc-button fc-state-default fc-corner-right hidden" aria-label="next"><span class="fc-icon fc-icon-right-single-arrow hidden"></span></button></div></div>
                            <button onclick="window.print()" type="button" class="btn btn-primary  pull-left rounded rounded-lg createBtn coursesBtn mr-3">
                                Download Report
                            </button>



                        </div>

                    </div>
                </div>
            </div>

        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <div class="card">
                <div class="p-5">
                    <div class="row datatablesData AttendanceTableCon">
                        

                        <div class="col-md-8 attendance-subheading">
                            <span id="heading"> @ViewBag.LessonName</span> <br>
                                 @ViewBag.SubjectName
                            <div class="form-row my-4 mb-4">
                                @*<div class="form-group col-md-12 bmd-form-group">
                                    <label for="" class="bmd-label-static pl-2">Select Class*</label>
                                    <select class="form-control" style="color: #b9cbe1;">
                                        <option selected="">Select</option>
                                        <option value="">Selection 1</option>
                                        <option value="">Selection 2</option>
                                    </select>
                                </div>*@
                            </div>
                        </div>
                        <div class="col-md-4">
                            @*<button type="button" class="btn btn-primary pull-right rounded rounded-lg createBtn coursesBtn">
                                View
                                All Courses
                            </button>*@
                        </div>



                  
                    </div>
                    <div class="row">
                        <div class="col-sm-12 datatablesData AttendanceTableCon table-responsive-lg">
                            <table class="display table table-hover dataTable no-footer  mb-0" role="grid" id="TeacherAttendanceTable">
                                <thead>
                                    <tr role="row">
                                        <th class="attNumber" style="width: 2%;">#</th>
                                        <th class="sorting" rowspan="1" colspan="1" aria-label="Name: activate to sort column ascending" style="width: 6%;">Name</th>
                                        <th class="sorting" rowspan="1" colspan="1" aria-label="Roll Number: activate to sort column ascending" style="width: 11%;">Status</th>
                                        <th class="sorting" rowspan="1" colspan="1" aria-label="Email: activate to sort column ascending" style="width: 16%;">Attendance Time</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <input type="hidden" name="LessonID" id="LessonID" value="@ViewBag.LessonID" />
                                     <tr role="row" class="rowHere">
                                       
                                    </tr>

                                </tbody>
                            </table>

                        </div>
                    </div>
                </div>
            </div>

        </div>

    </div>
</div>

<!--   Core JS Files   -->

<script>

    $(document).ready(function () {
        //$("#PageHeader").html("Lesson Attendance");

        var LessonID = $("#LessonID").val();
        var URL = '/AspnetLessons/Edit?id=' + LessonID;
        $("#BreadCrumbs").append(' <li> <a  href="/Teacher/Index"> Home </a> <span>&gt;</span></li>');
        $("#BreadCrumbs").append(' <li> <a href="/AspnetSubjectTopics/ViewTopicsAndLessons"> Topics & Lessons </a> <span>&gt;</span></li>');
        $("#BreadCrumbs").append(' <li><a id="BreadCrumps1" href="' + URL + '">Lesson</a><span>&gt;</span></li>');
        $("#BreadCrumbs").append(' <li class="active"><a id="BreadCrumps1" href="#">Report</a></li>');
    });



    var LessonID = $("#LessonID").val();
    $.ajax({

        type: "POST",
        url: "/AspNetLessons/GetLessonAttendance",
        data: { "LessonID": LessonID },
        success: function (data) {
            var j = 1;
            for (var i = 0; i <= data.length; i++) {
                if (data[i].LessonStatus == "Present") {
                    $("#TeacherAttendanceTable").append("<tr><td class='attNumber'>" + j + "</td><td>" + data[i].StudentName + "</td><td><div class='fc-button-group attendance-btn'><button type='button' class='fc-month-button fc-button fc-state-default fc-corner-left att-present-btn selected'><input type='radio' name='record_2' class='record_id_1' value='Present' checked>            <i class='fa fa-check' aria-hidden='true'></i>            Present        </button>        <button type='button' class='fc-agendaWeek-button fc-button fc-state-default att-absent-btn'><input type='radio' name='record_2' class='record_id_1' value='Absent'><i class='fa fa-times' aria-hidden='true'></i>Absent</button>        <button type='button' class='fc-listWeek-button fc-button fc-state-default fc-corner-right att-late-btn'>            <input type='radio' name='record_2' class='record_id_1' value='Late'>            <i class='fa fa-minus' aria-hidden='true'></i>Late</button></div></td><td><div class='reasonText'>" + data[i].LessonStartDate + "</div></td></td></tr>");
                }
                else if (data[i].LessonStatus == "Absent") {
                    $("#TeacherAttendanceTable").append("<tr><td class='attNumber'>" + j + "</td><td>" + data[i].StudentName + "</td><td> <div class='fc-button-group attendance-btn'>  <button type='button' class='fc-month-button fc-button fc-state-default fc-corner-left att-present-btn'><input type='radio' name='record_1' class='record_id_1' value='Present'> <i class='fa fa-check' aria-hidden='true'></i>Present  </button> <button type='button' class='fc-agendaWeek-button fc-button fc-state-default att-absent-btn selected'> <input type='radio' name='record_1' class='record_id_1' value='Absent' checked> <i class='fa fa-times' aria-hidden='true'></i> Absent </button><button type='button' class='fc-listWeek-button fc-button fc-state-default fc-corner-right att-late-btn'>  <input type='radio' name='record_1' class='record_id_1' value='Late'><i class='fa fa-minus' aria-hidden='true'></i> Late</button></div> </td>  <td><div class='reasonText'>" + data[i].LessonStartDate + "</div></td></tr>")
                }
               else {
                    $("#TeacherAttendanceTable").append("<tr><td class='attNumber'>" + j + "</td><td>" + data[i].StudentName + "</td><td><div class='fc-button-group attendance-btn'><button type='button' class='fc-month-button fc-button fc-state-default fc-corner-left att-present-btn '><input type='radio' name='record_3' class='record_id_1' value='Present' > <i class='fa fa-check' aria-hidden='true'></i>Present</button> <button type='button' class='fc-agendaWeek-button fc-button fc-state-default att-absent-btn'><input type='radio' name='record_3' class='record_id_1' value='Absent'><i class='fa fa-times' aria-hidden='true'></i>Absent </button> <button type='button' class='fc-listWeek-button fc-button fc-state-default fc-corner-right att-late-btn selected' ><input type='radio' name='record_3' class='record_id_1' value='Late' checked>   <i class='fa fa-minus' aria-hidden='true'></i>Late </button></div>  </td>  <td><div class='reasonText'>" + data[i].LessonStartDate + "</div></td></tr>")

                }
                j++;
    }
                
            


        }

    })





</script>


